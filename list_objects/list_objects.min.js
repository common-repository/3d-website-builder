/**
* Author URI:  https://3dwebsitebuilder.com/
* Author : Keivan Kamali
*/
wb3d_read_delete_list_objects(-1);jQuery("#file_import").css("display","none");jQuery("#file_import").removeClass("wb3d_displaynone");jQuery("#addslider").click(function(){jQuery("#ves_waiting").css("display","");id_ves=(new Date).getTime().toString();jQuery.post(wb3d.wb3d_ADMIN_URL+"admin-ajax.php",{action:"wb3d_new",id_ves:1,id_ves_new:id_ves,name:"new_wb3d",wb3d_nonce:wb3d.wb3d_nonce},function(c){jQuery("#ves_waiting").css("display","none");wb3d_copy_wb3d(c)})});
function wb3d_append_wb3d(c,a){var d=wb3d.wb3d_ADMIN_URL+"admin.php?page=wb3d_main&id="+c[a].id_ves+"&name="+c[a].name;var b='<div id="wb3dindex_'+a+'" style="    display: block;float: left; text-align: left;position:relative;margin:10px;width: 294px;height: 185px;background-color:#ccc;border-radius:10px;box-shadow:0px 0px 20px 8px rgba(0,0,0,0.53)"><lable style="position:absolute;top: 8px;left: 97px;"> Id='+(c[a].id_ves+"</lable>");b+='<input title="name" id="inputwb3d_'+a+'"   style="background-color:#ccc; border-radius:5px;position:absolute;top: 32px;left: 71px;width: 155px;height: 30px;" type="text" value="'+
c[a].name+'">';b+='<div id="labelwb3d_'+a+'" style="position:absolute;text-align:center;top: 76px;left: 10px;width: 272px;">[wb3d_object alias="'+c[a].name+'"]</div>';b+='<img title="Rename & Save" class="wb3d_pointer" id="renamewb3d_'+a+'" src="'+wb3d.wb3d_plagin_images_URL+'pen.png" style="width: 15px;height: 15px;top: 18px;left: 66px;position:absolute;">';b+='<img class="wb3d_pointer" id="wb3d_thumbnail_'+a+'" src="'+c[a].thumbnail+'" style="border-radius:5px;top: 103px;left: 10px;;width:100px;height:70px;position:absolute">';
b=b+('<a id="wb3d_name_'+a+'"  target="_blank"  href="'+d+'"><img src="')+(wb3d.wb3d_plagin_images_URL+'set.png" style="top: 116px;left: 112px;;width:45px;height:45px;border-radius:20%; position:absolute">');b=b+'</a><img class="wb3d_pointer" id="copywb3d_'+(a+'"  src="'+wb3d.wb3d_plagin_images_URL+'copy.jpg" style="top: 118px;left: 160px;;width:40px;height:40px;border-radius:50%;position:absolute">');b+='<img class="wb3d_pointer" id="exportwb3d_'+a+'"  src="'+wb3d.wb3d_plagin_images_URL+'export.png" style="top: 118px;left: 203px;;width:40px;height:40px;border-radius:50%;position:absolute">';
b+='<img class="wb3d_pointer" id="deletewb3d_'+a+'" src="'+wb3d.wb3d_plagin_images_URL+'close3.png" style="top: 119px;left: 245px;;width:40px;height:40px;border-radius:50%;position:absolute">';b+=' <div style="width:100px;height40px;background-color:#aaa;"></div></div> ';jQuery("#wb3d_objects_sub").append(b);jQuery("#inputwb3d_"+a).on("input",function(e){jQuery(this).val(jQuery(this).val().replace(/[^a-z0-9_]/gi,""))})}
jQuery("#file_import").on("change",function(c){c=c.target.files;var a=jQuery("#file_import")[0].files[0];var d=jQuery("#replace_ves").is(":checked")?"1":"0";var b=new FormData;b.append("action","wb3d_import_file");b.append("file",a);b.append("replace_ves",d);b.append("wb3d_nonce",wb3d.wb3d_nonce);for(d=10;0<d&&void 0==c[0].name.split(".")[d];d--);"zip"!=c[0].name.split(".")[d]?alert(jQuery("#alert_listObj1").text()):(jQuery("#ves_waiting").css("display",""),jQuery.ajax({url:wb3d.wb3d_ADMIN_URL+"admin-ajax.php",
type:"POST",data:b,contentType:!1,processData:!1,xhr:function(){var e=new window.XMLHttpRequest;e.upload.addEventListener("progress",function(f){f.lengthComputable&&parseInt(f.loaded/f.total*100)},!1);return e},success:function(e){jQuery("#ves_waiting").css("display","none");-1==e?alert(jQuery("#alert_listObj2").text()):2==e?alert(jQuery("#alert_listObj3").text()):0==e?alert(jQuery("#alert_importerror").text()):(alert(jQuery("#alert_listObj4").text()),jQuery("#wb3d_objects_sub").empty(),wb3d_read_data_demo(e,
1));jQuery("#file_import").val("")},error:function(){alert(jQuery("#alert_listObj5").text())}}))});jQuery("#import_slider").click(function(){jQuery("#file_import").click()});
function wb3d_read_data_demo(c,a){wb3d_data=wb3d_data_s=c=JSON.parse(c);document.addEventListener("mouseup",function(d){for(d=0;d<wb3d_data_s.length&&void 0!=c[d];d++)jQuery("#inputwb3d_"+d).css("background-color","#ccc"),c[d].name!=jQuery("#inputwb3d_"+d).val()&&jQuery("#inputwb3d_"+d).val(c[d].name)});for(a=0;a<=wb3d_data_s.length-1;a++)wb3d_append_wb3d(c,a),wb3d_set_click_wb3d_copy(a,c),wb3d_set_click_wb3d_delete(a),wb3d_set_click_wb3d_input(a,c),wb3d_set_click_wb3d_rename(a,c),wb3d_set_click_wb3d_change_thumbnail(a,
c)}function wb3d_copy_wb3d(c){c=jQuery.parseJSON(c);wb3d_data_s[wb3d_data_s.length]=c;wb3d_append_wb3d(wb3d_data_s,wb3d_data_s.length-1,0);wb3d_set_click_wb3d_copy(wb3d_data_s.length-1);wb3d_set_click_wb3d_delete(wb3d_data_s.length-1);wb3d_set_click_wb3d_input(wb3d_data_s.length-1,wb3d_data_s);wb3d_set_click_wb3d_rename(wb3d_data_s.length-1,wb3d_data_s);wb3d_set_click_wb3d_change_thumbnail(wb3d_data_s.length-1,wb3d_data_s)}
function wb3d_set_click_wb3d_delete(c){jQuery("#deletewb3d_"+c).click(function(){if(confirm(jQuery("#alert_listObj7").text())){var a=this.id.split("_")[1];jQuery("#ves_waiting").css("display","");wb3d_read_delete_list_objects(a)}})}
function wb3d_read_delete_list_objects(c){jQuery("#ves_waiting").css("display","");jQuery.post(wb3d.wb3d_ADMIN_URL+"admin-ajax.php",{action:"wb3d_delete",wb3d_nonce:wb3d.wb3d_nonce,id_ves:-1==c?-1:wb3d_data[c].id_ves},function(a){jQuery("#ves_waiting").css("display","none");jQuery("#wb3d_objects_sub").empty();wb3d_read_data_demo(a,1)})}
function wb3d_set_click_wb3d_input(c,a){jQuery("#inputwb3d_"+c).click(function(d){for(var b=this.id.split("_")[1],e=0;e<=a.length-1;e++)e!=b&&(jQuery("#inputwb3d_"+e).css("background-color","#ccc"),a[e].name!=jQuery("#inputwb3d_"+e).val()&&jQuery("#inputwb3d_"+e).val(a[e].name));jQuery("#inputwb3d_"+b).css("background-color","#fff");d.stopPropagation()});document.getElementById("inputwb3d_"+c).addEventListener("mouseup",function(d){d.stopPropagation()})}
function wb3d_set_click_wb3d_copy(c){jQuery("#exportwb3d_"+c).click(function(){jQuery("#ves_waiting").css("display","");var a=this.id.split("_")[1],d=wb3d_data[a].id_ves;jQuery.post(wb3d.wb3d_ADMIN_URL+"admin-ajax.php",{action:"wb3d_export",wb3d_nonce:wb3d.wb3d_nonce,id_ves:d,name:wb3d_data[a].name,url:wb3d.wb3d_BASE_URL},function(b){jQuery("#ves_waiting").css("display","none");location.href=wb3d.wb3d_plagin_URL+"backup/"+d+".zip"})});jQuery("#copywb3d_"+c).click(function(){var a=this.id.split("_")[1];
jQuery("#ves_waiting").css("display","");var d=(new Date).getTime().toString();jQuery.post(wb3d.wb3d_ADMIN_URL+"admin-ajax.php",{action:"wb3d_copy",wb3d_nonce:wb3d.wb3d_nonce,id_ves:wb3d_data[a].id_ves,name:wb3d_data[a].name,id_ves_new:d},function(b){jQuery("#ves_waiting").css("display","none");wb3d_copy_wb3d(b)})})}
function wb3d_set_click_wb3d_change_thumbnail(c){jQuery("#wb3d_thumbnail_"+c).click(function(){var a=this.id.split("wb3d_thumbnail_")[1];event.preventDefault();var d=wp.media({title:"Select or Upload Media Of Your Chosen Persuasion",button:{text:"Use this media"},library:{type:"image"},multiple:!1});d.on("select",function(){var b=d.state().get("selection").first().toJSON().url;jQuery("#ves_waiting").css("display","");jQuery.post(wb3d.wb3d_ADMIN_URL+"admin-ajax.php",{action:"wb3d_change_thumbnail",
wb3d_nonce:wb3d.wb3d_nonce,id_ves:wb3d_data[a].id_ves,thumbnail:b},function(e){jQuery("#ves_waiting").css("display","none");jQuery("#wb3d_thumbnail_"+a).attr("src",b)})});d&&d.open()})}
function wb3d_set_click_wb3d_rename(c,a){jQuery("#renamewb3d_"+c).mouseup(function(d){d.stopPropagation()});jQuery("#renamewb3d_"+c).click(function(d){var b=this.id.split("_")[1];jQuery("#ves_waiting").css("display","");if(a[b].name==jQuery("#inputwb3d_"+b).val())jQuery("#ves_waiting").css("display","none"),jQuery("#inputwb3d_"+b).css("background-color","#ccc");else{jQuery("#inputwb3d_"+b).prop("disabled",!0);var e={action:"wb3d_rename",wb3d_nonce:wb3d.wb3d_nonce,id_ves:wb3d_data[b].id_ves,name:jQuery("#inputwb3d_"+
b).val()};jQuery.post(wb3d.wb3d_ADMIN_URL+"admin-ajax.php",e,function(f){jQuery("#ves_waiting").css("display","none");0==f?(a[b].name=jQuery("#inputwb3d_"+b).val(),jQuery("#labelwb3d_"+b).text('[wb3d_object alias="'+a[b].name+'"]')):(alert(jQuery("#alert_listObj6").text()),jQuery("#inputwb3d_"+b).val(a[b].name));jQuery("#inputwb3d_"+b).css("background-color","#ccc");jQuery("#inputwb3d_"+b).prop("disabled",!1);f=wb3d.wb3d_ADMIN_URL+"admin.php?page=wb3d_main&id="+a[b].id_ves+"&name="+a[b].name;jQuery("#wb3d_name_"+
b).attr("href",f)})}d.stopPropagation()})};